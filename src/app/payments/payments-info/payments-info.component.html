<mat-toolbar color="accent">
 View Payment History
</mat-toolbar>
<mat-dialog-content class="payment-history">

  <!-- Form fields -->
  <mat-form-field class="payment-history-field">
    <mat-label>Clinic ID</mat-label>
    <input type="text" matInput placeholder="5" [(ngModel)]="this.clinicID" name="clinic_id" value="{{this.clinicID}}">
  </mat-form-field>
  <mat-form-field appearance="fill" class="payment-history-field">
    <mat-label>Choose a starting date</mat-label>
    <input matInput [max]="maxDate1" [matDatepicker]="picker" [(ngModel)]="this.startDate" name="start_date">
    <mat-hint>YYYY-MM-DD</mat-hint>
    <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
    <mat-datepicker #picker></mat-datepicker>
  </mat-form-field>
  <mat-form-field appearance="fill" class="payment-history-field">
    <mat-label>Choose an end date</mat-label>
    <input matInput [min]="minDate2" [max]="maxDate2" [matDatepicker]="picker1" [(ngModel)]="this.endDate" name="end_id">
    <mat-hint>YYYY-MM-DD</mat-hint>
    <mat-datepicker-toggle matIconSuffix [for]="picker1"></mat-datepicker-toggle>
    <mat-datepicker #picker1></mat-datepicker>
  </mat-form-field>
  <br>
  <button mat-raised-button (click)="getPaymentHistory(this.clinicID,this.startDate,this.endDate)" color="accent" class="payment-history-button">View History</button>
  <button mat-raised-button (click)="resetForm()" color="warn">Reset</button>


<!-- Payment hitory table -->
<div class="clinic-users-component" *ngIf="paymentHistory?.length>0;else noPaymentHistory">
  <!-- <mat-card class="length-card">
    <mat-card-title>
      {{paymentHistory.length}}
    </mat-card-title>
    <mat-card-content>
      <p>
        No. of Payments Completed
      </p>
    </mat-card-content>
  </mat-card> -->
  <mat-card>
    <mat-card-content>
      <p color="warning">
        Appointment Type:
        0-Pending appointment/1-Wait for confirmation/2-Waiting for payment/3-Paid/4-Complete/5-Declined by doctor/6 - Online not paid
      </p>
      <p>
        Appointment Sub Type:
        0-Clinic/1-Home/2-remote
      </p>
    </mat-card-content>
  </mat-card>
  <br><br>
  <table mat-table matSort [dataSource]="paymentHistory" class="mat-elevation-z8" id="paymentHistory">
  
    <!-- <ng-container matColumnDef="logo">
      <th mat-header-cell mat-sort-header *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let clinic"> 
        <div class="img-logo">
          <img src={{clinic.logo}}>
        </div>
      </td>
    </ng-container> -->

    <ng-container matColumnDef="clinic_name">
      <th mat-header-cell mat-sort-header *matHeaderCellDef> Clinic Name </th>
      <td mat-cell *matCellDef="let payment"> {{payment.clinic_name}} </td>
    </ng-container>

    <ng-container matColumnDef="doctor_name">
      <th mat-header-cell mat-sort-header *matHeaderCellDef> Veterinarians Name </th>
      <td mat-cell *matCellDef="let payment"> {{payment.doctor_name}} </td>
    </ng-container>

    <ng-container matColumnDef="appointment_type">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>Appointment Type</th>
      <td mat-cell *matCellDef="let payment"> {{payment.a_type}} </td>
    </ng-container>

    <ng-container matColumnDef="appointment_subtype">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>Appointment Sub Type</th>
      <td mat-cell *matCellDef="let payment"> {{payment.a_sub_type}} </td>
    </ng-container>

    <ng-container matColumnDef="animal_name">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>Animal Name</th>
      <td mat-cell *matCellDef="let payment"> {{payment.animal_name}} </td>
    </ng-container>

    <ng-container matColumnDef="animal_type">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>Animal Type</th>
      <td mat-cell *matCellDef="let payment"> {{payment.animal_type}} </td>
    </ng-container>

    <ng-container matColumnDef="owner_name">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>Owner Name</th>
      <td mat-cell *matCellDef="let payment"> {{payment.owner_name}} </td>
    </ng-container>

    <ng-container matColumnDef="mobile">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>Mobile</th>
      <td mat-cell *matCellDef="let payment"> {{payment.mobile}} </td>
    </ng-container>

    <ng-container matColumnDef="owner_address">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>Owner Address</th>
      <td mat-cell *matCellDef="let payment"> {{payment.owner_address}} </td>
    </ng-container>

    <ng-container matColumnDef="owner_city">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>Owner City</th>
      <td mat-cell *matCellDef="let payment"> {{payment.owner_city}} </td>
    </ng-container>

    <ng-container matColumnDef="a_date">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>Appointment Date</th>
      <td mat-cell *matCellDef="let payment"> {{payment.a_date}} </td>
    </ng-container>

    <ng-container matColumnDef="a_time">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>Appointment Time</th>
      <td mat-cell *matCellDef="let payment"> {{payment.a_time}} </td>
    </ng-container>

    <!-- <ng-container matColumnDef="info">
      <th mat-header-cell mat-sort-header *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let user"> 
        <button mat-icon-button class="info-button" (click)="moreInfo(clinic.id)">
          <mat-icon>info</mat-icon>
        </button>  
      </td>
    </ng-container>

    <ng-container matColumnDef="edit">
      <th mat-header-cell mat-sort-header *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let clinic"> 
        <button mat-icon-button class="edit-button" (click)="editClinic(clinic.id)" color="primary">
          <mat-icon>edit</mat-icon>
        </button>  
      </td>
    </ng-container>
 -->
    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>
  <br><br>
  <button mat-raised-button (click)="downloadDoc()" color="primary" class="payment-history-button">Download Payment History</button>
</div>

<!-- If there is no data -->
<ng-template #noPaymentHistory>
  <hr>
  <mat-card class="no-payments">
    <mat-card-content class="no-payments-content">
      <h3>Select Clinic ID, starting and ending dates to view payment history</h3>
    </mat-card-content>
  </mat-card>
  
</ng-template>
</mat-dialog-content>
<mat-dialog-actions align="end">
  <button mat-button [mat-dialog-close]="true" cdkFocusInitial color="primary">OK</button>
</mat-dialog-actions>
